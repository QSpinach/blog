<!DOCTYPE html>
<html>
<head>
    

    

    



    <meta charset="utf-8">
    
    
    
    
    <title>搭建vue项目 | QSpinach&#39;blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="Vue">
    <meta name="description" content="搭建VUE项目概要本文档用于总结VUE项目的搭建及使用，基于不同的UI搭建原理其实是一样的。以Vant为例简单概述从项目创建到打包部署过程中需要注意的内容。 推荐UI​        移动端：vant-ui、cube-ui ​        PC端：element-ui、iView 环境 nvm(node版本管理工具) npm || yarn （包管理工具，高版本nodejs可能需要手动安装npm">
<meta name="keywords" content="Vue">
<meta property="og:type" content="article">
<meta property="og:title" content="搭建vue项目">
<meta property="og:url" content="https:&#x2F;&#x2F;qspinach.github.io&#x2F;blog&#x2F;2020&#x2F;08&#x2F;23&#x2F;%E6%90%AD%E5%BB%BAvue%E9%A1%B9%E7%9B%AE&#x2F;index.html">
<meta property="og:site_name" content="QSpinach&#39;blog">
<meta property="og:description" content="搭建VUE项目概要本文档用于总结VUE项目的搭建及使用，基于不同的UI搭建原理其实是一样的。以Vant为例简单概述从项目创建到打包部署过程中需要注意的内容。 推荐UI​        移动端：vant-ui、cube-ui ​        PC端：element-ui、iView 环境 nvm(node版本管理工具) npm || yarn （包管理工具，高版本nodejs可能需要手动安装npm">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2020-08-23T15:45:11.821Z">
<meta name="twitter:card" content="summary">
    
        <link rel="alternate" type="application/atom+xml" title="QSpinach&#39;blog" href="/blog/atom.xml">
    
    <link rel="shortcut icon" href="/blog/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/blog/img/brand.jpg)">
      <div class="brand">
        <a href="/blog/" class="avatar waves-effect waves-circle waves-light">
          <img src="/blog/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">QSpinach</h5>
          <a href="mailto:731044462@qq.com" target="_blank" rel="noopener" title="731044462@qq.com" class="mail">731044462@qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/blog/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/blog/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                归档
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/blog/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                标签
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/qspinach" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">搭建vue项目</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">搭建vue项目</h1>
        <h5 class="subtitle">
            
                <time datetime="2020-08-23T15:45:11.821Z" itemprop="datePublished" class="page-time">
  2020-08-23
</time>


            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#搭建VUE项目"><span class="post-toc-number">1.</span> <span class="post-toc-text">搭建VUE项目</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#概要"><span class="post-toc-number">1.0.1.</span> <span class="post-toc-text">概要</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#推荐UI"><span class="post-toc-number">1.0.2.</span> <span class="post-toc-text">推荐UI</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#环境"><span class="post-toc-number">1.0.3.</span> <span class="post-toc-text">环境</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#开始"><span class="post-toc-number">1.0.4.</span> <span class="post-toc-text">开始</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#创建项目"><span class="post-toc-number">1.0.4.1.</span> <span class="post-toc-text">创建项目</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#文件目录"><span class="post-toc-number">1.0.4.2.</span> <span class="post-toc-text">文件目录</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#添加适配方案"><span class="post-toc-number">1.0.4.3.</span> <span class="post-toc-text">添加适配方案</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#Rem-适配"><span class="post-toc-number">1.0.4.3.1.</span> <span class="post-toc-text">Rem 适配</span></a></li></ol></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#开发代理"><span class="post-toc-number">1.0.4.4.</span> <span class="post-toc-text">开发代理</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#优化引用三方库"><span class="post-toc-number">1.0.4.5.</span> <span class="post-toc-text">优化引用三方库</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#静态变量及环境变量"><span class="post-toc-number">1.0.4.6.</span> <span class="post-toc-text">静态变量及环境变量</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#工具文件"><span class="post-toc-number">1.0.4.7.</span> <span class="post-toc-text">工具文件</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#登录与微信登录"><span class="post-toc-number">1.0.5.</span> <span class="post-toc-text">登录与微信登录</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#权限"><span class="post-toc-number">1.0.6.</span> <span class="post-toc-text">权限</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#路由权限"><span class="post-toc-number">1.0.6.1.</span> <span class="post-toc-text">路由权限</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#按钮权限"><span class="post-toc-number">1.0.6.2.</span> <span class="post-toc-text">按钮权限</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#问题"><span class="post-toc-number">1.0.7.</span> <span class="post-toc-text">问题</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#简单部署"><span class="post-toc-number">1.0.8.</span> <span class="post-toc-text">简单部署</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Docker部署"><span class="post-toc-number">1.0.9.</span> <span class="post-toc-text">Docker部署</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#项目打包部署步骤"><span class="post-toc-number">1.0.9.1.</span> <span class="post-toc-text">项目打包部署步骤</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#docker安装"><span class="post-toc-number">1.0.9.2.</span> <span class="post-toc-text">docker安装</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#查看日志"><span class="post-toc-number">1.0.9.3.</span> <span class="post-toc-text">查看日志</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#几个命令"><span class="post-toc-number">1.0.9.4.</span> <span class="post-toc-text">几个命令</span></a></li></ol></li></ol></li></ol></li></ol>
        </nav>
    </aside>


<article id="post-搭建vue项目"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">搭建vue项目</h1>
        <div class="post-meta">
            <time class="post-time" title="2020-08-23 23:45:11" datetime="2020-08-23T15:45:11.821Z"  itemprop="datePublished">2020-08-23</time>

            


            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h1 id="搭建VUE项目"><a href="#搭建VUE项目" class="headerlink" title="搭建VUE项目"></a>搭建VUE项目</h1><h3 id="概要"><a href="#概要" class="headerlink" title="概要"></a>概要</h3><p>本文档用于总结VUE项目的搭建及使用，基于不同的UI搭建原理其实是一样的。以Vant为例简单概述从项目创建到打包部署过程中需要注意的内容。</p>
<h3 id="推荐UI"><a href="#推荐UI" class="headerlink" title="推荐UI"></a>推荐UI</h3><p>​        移动端：<a href="https://youzan.github.io/vant/#/zh-CN?_blank" target="_blank" rel="noopener">vant-ui</a>、<a href="https://didi.github.io/cube-ui/#/zh-CN/docs/quick-start?_blank" target="_blank" rel="noopener">cube-ui</a></p>
<p>​        PC端：<a href="https://element.eleme.cn/#/zh-CN/component/installation?_blank" target="_blank" rel="noopener">element-ui</a>、<a href="https://www.iviewui.com/docs/introduce?_blank" target="_blank" rel="noopener">iView</a></p>
<h3 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h3><ol>
<li><a href="https://github.com/coreybutler/nvm-windows/releases" target="_blank" rel="noopener">nvm</a>(node版本管理工具)</li>
<li>npm || yarn （包管理工具，高版本nodejs可能需要手动安装npm）</li>
<li><a href="https://nodejs.org/zh-cn/download/releases/" target="_blank" rel="noopener">nodejs</a>（运行环境）</li>
</ol>
<h3 id="开始"><a href="#开始" class="headerlink" title="开始"></a>开始</h3><h4 id="创建项目"><a href="#创建项目" class="headerlink" title="创建项目"></a>创建项目</h4><p>以<code>vant-ui</code>为例子搭建，使用 Vue 官方提供的脚手架 <a href="https://cli.vuejs.org/zh/" target="_blank" rel="noopener">Vue Cli 3</a> 创建项目</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装 Vue Cli</span></span><br><span class="line">npm install -g @vue/cli</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一个项目</span></span><br><span class="line">vue create hello-world</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建完成后，可以通过命令打开图形化界面，如下图所示</span></span><br><span class="line">vue ui</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过 npm 安装</span></span><br><span class="line">npm i vant -S</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过 yarn 安装</span></span><br><span class="line">yarn add vant</span><br></pre></td></tr></table></figure>



<h4 id="文件目录"><a href="#文件目录" class="headerlink" title="文件目录"></a>文件目录</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">│  .env.development</span><br><span class="line">│  .env.production</span><br><span class="line">│  .env.sit</span><br><span class="line">│  .env.uat</span><br><span class="line">│  .eslintrc.js</span><br><span class="line">│  .gitignore</span><br><span class="line">│  babel.config.js</span><br><span class="line">│  Dockerfile</span><br><span class="line">│  nginx.conf</span><br><span class="line">│  package-lock.json</span><br><span class="line">│  package.json</span><br><span class="line">│  README.md</span><br><span class="line">│  vue.config.js</span><br><span class="line">│  yarn.lock</span><br><span class="line">│  </span><br><span class="line">├─public</span><br><span class="line">│  │  favicon.ico</span><br><span class="line">│  │  index.html</span><br><span class="line">│  │  </span><br><span class="line">│  └─svg</span><br><span class="line">│          loading-spin.svg</span><br><span class="line">│          </span><br><span class="line">└─src</span><br><span class="line">    │  App.vue</span><br><span class="line">    │  error.js</span><br><span class="line">    │  main.js</span><br><span class="line">    │  permission.js</span><br><span class="line">    │  vant-ui.js</span><br><span class="line">    │  </span><br><span class="line">    ├─api</span><br><span class="line">    │      index.js</span><br><span class="line">    │      login.js</span><br><span class="line">    │      user.js</span><br><span class="line">    │      </span><br><span class="line">    ├─assets</span><br><span class="line">    │    back.png</span><br><span class="line">    │    login.jpg</span><br><span class="line">    │    logo.png</span><br><span class="line">    │          </span><br><span class="line">    ├─components</span><br><span class="line">    │  └─404</span><br><span class="line">    │          index.vue</span><br><span class="line">    │          </span><br><span class="line">    ├─configs</span><br><span class="line">    │      apiURL.js</span><br><span class="line">    │      errorCode.js</span><br><span class="line">    │      index.js</span><br><span class="line">    │      </span><br><span class="line">    ├─routers</span><br><span class="line">    │  │  index.js</span><br><span class="line">    │  │  </span><br><span class="line">    │  └─modules</span><br><span class="line">    │          default.js</span><br><span class="line">    │          </span><br><span class="line">    ├─stores</span><br><span class="line">    │  │  getters.js</span><br><span class="line">    │  │  index.js</span><br><span class="line">    │  │  </span><br><span class="line">    │  └─modules</span><br><span class="line">    │          permission.js</span><br><span class="line">    │          user.js</span><br><span class="line">    │          </span><br><span class="line">    ├─styles</span><br><span class="line">    │      transition.css</span><br><span class="line">    │      </span><br><span class="line">    ├─utils</span><br><span class="line">    │      auth.js</span><br><span class="line">    │      index.js</span><br><span class="line">    │      request.js</span><br><span class="line">    │      validate.js</span><br><span class="line">    │      </span><br><span class="line">    └─views</span><br><span class="line">        │              </span><br><span class="line">        ├─home</span><br><span class="line">        │      Home.vue</span><br><span class="line">        │      Home2.vue</span><br><span class="line">        │      </span><br><span class="line">        ├─login</span><br><span class="line">        │      Login.vue</span><br><span class="line">        │      </span><br><span class="line">        └─test</span><br><span class="line">               Test.vue</span><br></pre></td></tr></table></figure>



<h4 id="添加适配方案"><a href="#添加适配方案" class="headerlink" title="添加适配方案"></a>添加适配方案</h4><h5 id="Rem-适配"><a href="#Rem-适配" class="headerlink" title="Rem 适配"></a>Rem 适配</h5><p>Vant 中的样式默认使用<code>px</code>作为单位，如果需要使用<code>rem</code>单位，推荐使用以下两个工具：</p>
<ul>
<li><p><a href="https://github.com/cuth/postcss-pxtorem" target="_blank" rel="noopener">postcss-pxtorem</a> 是一款 postcss 插件，用于将单位转化为 rem</p>
</li>
<li><p><a href="https://github.com/amfe/lib-flexible" target="_blank" rel="noopener">lib-flexible</a> 用于设置 rem 基准值</p>
<p>在vue.config.js中配置即可完成适配</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">css: &#123;</span><br><span class="line">    loaderOptions: &#123;</span><br><span class="line">      postcss: &#123;</span><br><span class="line">        plugins: [</span><br><span class="line">          autoprefixer(),</span><br><span class="line">          pxtorem(&#123;</span><br><span class="line">            rootValue: <span class="number">37.5</span>,</span><br><span class="line">            propList: [<span class="string">'*'</span>]</span><br><span class="line">          &#125;)</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>



</li>
</ul>
<h4 id="开发代理"><a href="#开发代理" class="headerlink" title="开发代理"></a>开发代理</h4><p>方便开发对接接口及方便管理使用代理，生产可使用nginx做代理</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">devServer: &#123;</span><br><span class="line">    <span class="comment">// 设置主机地址</span></span><br><span class="line">    <span class="comment">// host: 'localhost',</span></span><br><span class="line">    <span class="comment">// 设置默认端口</span></span><br><span class="line">    port: <span class="number">8000</span>,</span><br><span class="line">    <span class="comment">// 设置代理</span></span><br><span class="line">    disableHostCheck: <span class="literal">true</span>,</span><br><span class="line">    proxy: &#123;</span><br><span class="line">        <span class="string">'/v2'</span>: &#123;</span><br><span class="line">          <span class="comment">// 目标 API 地址</span></span><br><span class="line">          target: <span class="string">'http://rap2api.taobao.org'</span>,</span><br><span class="line">          <span class="comment">// 如果要代理 websockets</span></span><br><span class="line">          ws: <span class="literal">true</span>,</span><br><span class="line">          <span class="comment">// 将主机标头的原点更改为目标URL</span></span><br><span class="line">          <span class="comment">// changeOrigin: true,</span></span><br><span class="line">          pathRewrite: &#123;</span><br><span class="line">            <span class="string">'^/v2'</span>: <span class="string">'/app/mock'</span>    <span class="comment">//代理的路径</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>



<h4 id="优化引用三方库"><a href="#优化引用三方库" class="headerlink" title="优化引用三方库"></a>优化引用三方库</h4><p>使用webpack-bundle-analyzer可以查看各部分打包后的大小，如果太大需要做特殊引用。</p>
<p>在index.html中引用三方库</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"//shadow.elemecdn.com/npm/vue@2.6.10/dist/vue.runtime&lt;%= process.env.NODE_ENV === 'production' ? '.min.js' : '.js' %&gt;"</span> <span class="attr">crossorigin</span>=<span class="string">"anonymous"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"//shadow.elemecdn.com/npm/vue-router@3.0.3/dist/vue-router&lt;%= process.env.NODE_ENV === 'production' ? '.min.js' : '.js' %&gt;"</span> <span class="attr">crossorigin</span>=<span class="string">"anonymous"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在vue.config.js中配置三方库</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">configureWebpack: &#123;</span><br><span class="line">    plugins: [</span><br><span class="line">      <span class="keyword">new</span> BundleAnalyzerPlugin()</span><br><span class="line">      <span class="comment">// 其他 plugins ...</span></span><br><span class="line">    ],</span><br><span class="line">    externals: &#123;</span><br><span class="line">      vue: <span class="string">"window.Vue"</span>,</span><br><span class="line">      <span class="string">"vue-router"</span>: <span class="string">"window.VueRouter"</span></span><br><span class="line">      <span class="comment">// 其他三方库 ...</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>



<h4 id="静态变量及环境变量"><a href="#静态变量及环境变量" class="headerlink" title="静态变量及环境变量"></a>静态变量及环境变量</h4><p>根据不同的启动命令获取不同的环境变量值，在package.json中配置运行命令执行不同命令会使用不同文件下定义的变量。例如：.env.development、.env.production、.env.sit、.env.uat文件中，默认yarn dev使用development，yarn build使用production，还可以自己添加sit和uat。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"scripts"</span>: &#123;</span><br><span class="line">    <span class="string">"dev"</span>: <span class="string">"npm run serve"</span>,</span><br><span class="line">    <span class="string">"build"</span>: <span class="string">"vue-cli-service build"</span>,</span><br><span class="line">    <span class="string">"sit"</span>: <span class="string">"vue-cli-service build --mode sit"</span>,</span><br><span class="line">    <span class="string">"uat"</span>: <span class="string">"vue-cli-service build --mode uat"</span></span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>

<p>在.env.development中</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">NODE_ENV=<span class="string">'development'</span></span><br><span class="line">VUE_APP_CURRENTMODE=<span class="string">'development'</span></span><br><span class="line">VUE_APP_BASEURL=<span class="string">'http://127.0.0.1:8001'</span></span><br></pre></td></tr></table></figure>

<p>在.env.production中</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">NODE_ENV=<span class="string">'production'</span></span><br><span class="line">VUE_APP_CURRENTMODE=<span class="string">'production'</span></span><br><span class="line">VUE_APP_BASEURL=<span class="string">'http://127.0.0.1:8002'</span></span><br></pre></td></tr></table></figure>

<p>在代码中的使用变量</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> baseUrl = process.env.VUE_APP_BASEURL</span><br></pre></td></tr></table></figure>

<p>静态变量定义在指定文件中，使用时即可引用。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 配置静态变量</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">// 路由白名单</span></span><br><span class="line"><span class="keyword">const</span> whiteList = [</span><br><span class="line">  <span class="string">'/login'</span>, <span class="comment">// 登录</span></span><br><span class="line">  <span class="string">'/404'</span></span><br><span class="line">]</span><br><span class="line"><span class="keyword">const</span> baseUrl = process.env.VUE_APP_BASEURL</span><br><span class="line"><span class="keyword">const</span> imgUrl = baseUrl <span class="comment">// 图片服务器地址</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123;</span><br><span class="line">  whiteList,</span><br><span class="line">  imgUrl</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="工具文件"><a href="#工具文件" class="headerlink" title="工具文件"></a>工具文件</h4><ol>
<li><p>自定义request.js封装axios作为调用接口工具。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 返回其他状态吗</span></span><br><span class="line">service.defaults.validateStatus = <span class="function"><span class="keyword">function</span> (<span class="params">status</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> status &gt;= <span class="number">200</span> &amp;&amp; status &lt;= <span class="number">500</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 处理请求头</span></span><br><span class="line">axios.interceptors.request.use(<span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> isToken = (config.headers || &#123;&#125;).isToken === <span class="literal">false</span></span><br><span class="line">  <span class="keyword">let</span> token =  store.getters.access_token <span class="comment">// 可以根据vuex或者storage获取</span></span><br><span class="line">  <span class="keyword">if</span> (token &amp;&amp; !isToken) &#123;</span><br><span class="line">    config.headers[<span class="string">'Authorization'</span>] = <span class="string">'Bearer '</span> + token <span class="comment">// token</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> config</span><br><span class="line">&#125;, error =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 处理返回信息</span></span><br><span class="line">axios.interceptors.response.use(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> status = <span class="built_in">Number</span>(res.status) || <span class="number">200</span></span><br><span class="line">  <span class="keyword">const</span> message = res.data.error_description || errorCode[status] || errorCode[<span class="string">'default'</span>]</span><br><span class="line">  <span class="keyword">if</span> (status === <span class="number">401</span>) &#123;</span><br><span class="line">    <span class="comment">// TODO 登出</span></span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (!(status === <span class="number">200</span> || status === <span class="number">204</span>)) &#123;</span><br><span class="line">    <span class="comment">// TODO 提示错误信息</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(<span class="keyword">new</span> <span class="built_in">Error</span>(message))</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> res</span><br><span class="line">&#125;, error =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(<span class="keyword">new</span> <span class="built_in">Error</span>(error))</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>在调用接口时候即可使用request工具</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> request <span class="keyword">from</span> <span class="string">'@/utils/request'</span></span><br><span class="line"><span class="keyword">import</span> &#123; apiUrl &#125; <span class="keyword">from</span> <span class="string">'@/configs/apiURL'</span></span><br><span class="line"><span class="keyword">const</span> login = apiUrl.login</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> LoginByMobile = <span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> request(&#123;</span><br><span class="line">    url: login.doLogin,</span><br><span class="line">    method: <span class="string">'POST'</span>,</span><br><span class="line">    type: <span class="string">'json'</span>,</span><br><span class="line">    data,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果想为了方便管理接口地址，可以将接口地址统一管理</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> baseUrl = <span class="string">"/v1"</span> <span class="comment">// 代理地址</span></span><br><span class="line"><span class="keyword">const</span> baseUrlMock = <span class="string">"/v2"</span> <span class="comment">// mock地址</span></span><br><span class="line"><span class="keyword">const</span> apiUrlFn = <span class="function">(<span class="params">baseUrl</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    login: &#123;</span><br><span class="line">      doLogin: baseUrl + <span class="string">"/app/login"</span>, <span class="comment">// 登录</span></span><br><span class="line">      doLogout: baseUrl + <span class="string">"/app/logout"</span> <span class="comment">// 登出</span></span><br><span class="line">    &#125;,</span><br><span class="line">    user: &#123;</span><br><span class="line">      getUserInfo: baseUrlMock + <span class="string">"/app/userinfo"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> apiUrl = apiUrlFn(baseUrl);</span><br><span class="line"><span class="keyword">export</span> &#123;</span><br><span class="line">  baseUrl,</span><br><span class="line">  baseUrlMock,</span><br><span class="line">  apiUrl</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





</li>
</ol>
<p>   根据不同状态码提示不同的信息，可以做一个errorCode静态变量对象</p>
   <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="string">'401'</span>: <span class="string">'当前操作没有权限'</span>,</span><br><span class="line">  <span class="string">'default'</span>: <span class="string">'系统未知错误,请反馈给管理员'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li><p>自定义validate.js作为数据校验工具</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 大小写字母*/</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">validateAlphabets</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> reg = <span class="regexp">/^[A-Za-z]+$/</span></span><br><span class="line">  <span class="keyword">return</span> reg.test(str)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 小写字母*/</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">validateLowerCase</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> reg = <span class="regexp">/^[a-z]+$/</span></span><br><span class="line">  <span class="keyword">return</span> reg.test(str)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



</li>
</ol>
<ol start="3">
<li><p>自定义auth.js作为存储登录token工具（可以用cookie，sessionStorage，localStorage）</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Cookies <span class="keyword">from</span> <span class="string">'js-cookie'</span></span><br><span class="line"><span class="keyword">const</span> TokenKey = <span class="string">'Token'</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">getToken</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> Cookies.get(TokenKey)</span><br><span class="line">  <span class="comment">// return sessionStorage.getItem(TokenKey)</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">setToken</span>(<span class="params">token</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// return Cookies.set(TokenKey, token, &#123;expires: 0.001&#125;) // 过期时间一分多钟</span></span><br><span class="line">  <span class="keyword">return</span> Cookies.set(TokenKey, token, &#123;<span class="attr">expires</span>: <span class="number">7</span>&#125;) <span class="comment">// 过期时间7天</span></span><br><span class="line">  <span class="comment">// return sessionStorage.setItem(TokenKey, token)</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">removeToken</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> Cookies.remove(TokenKey)</span><br><span class="line">  <span class="comment">// return sessionStorage.removeItem(TokenKey)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>自定义其他一些好用的数据处理工具</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 获取地址栏参数</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">getUrlParam</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> reg = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">"(^|&amp;)"</span> + name + <span class="string">"=([^&amp;]*)(&amp;|$)"</span>); <span class="comment">//构造一个含有目标参数的正则表达式对象</span></span><br><span class="line">  <span class="keyword">var</span> r = <span class="built_in">window</span>.location.search.substr(<span class="number">1</span>).match(reg);  <span class="comment">//匹配目标参数</span></span><br><span class="line">  <span class="keyword">if</span> (r != <span class="literal">null</span>) <span class="keyword">return</span> <span class="built_in">unescape</span>(r[<span class="number">2</span>]); <span class="keyword">return</span> <span class="literal">null</span>; <span class="comment">//返回参数值</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



</li>
</ol>
<h3 id="登录与微信登录"><a href="#登录与微信登录" class="headerlink" title="登录与微信登录"></a>登录与微信登录</h3><p>登录需用到vuex和storage以便存储和获取登录用户信息</p>
<p>在store中定义user</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">state: &#123;</span><br><span class="line">    user: <span class="string">''</span>,</span><br><span class="line">    name: <span class="string">''</span>,</span><br><span class="line">    token: getToken(),</span><br><span class="line">    roles: [],</span><br><span class="line">  &#125;,</span><br><span class="line">actions: &#123;</span><br><span class="line">    LoginByMobile(&#123;commit&#125;, userinfo)&#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">         login.LoginByMobile(userinfo).then(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">           <span class="keyword">const</span> &#123; code, msg, token &#125; = response.data</span><br><span class="line">           <span class="keyword">if</span> (code != <span class="number">0</span>) &#123;</span><br><span class="line">               <span class="comment">// TODO 提示登录失败</span></span><br><span class="line">             reject(<span class="string">"登录失败"</span>)</span><br><span class="line">             <span class="keyword">return</span>;</span><br><span class="line">           &#125;</span><br><span class="line">           commit(<span class="string">'SET_TOKEN'</span>, token)</span><br><span class="line">           commit(<span class="string">'SET_NAME'</span>, <span class="string">""</span>)</span><br><span class="line">           setToken(token)</span><br><span class="line">           resolve(response)</span><br><span class="line">         &#125;).catch(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">           reject(error)</span><br><span class="line">         &#125;)</span><br><span class="line">       &#125;)</span><br><span class="line">     &#125;,</span><br><span class="line">&#125;,</span><br><span class="line"><span class="comment">// 获取用户信息</span></span><br><span class="line">    GetUserInfo(&#123; commit, state &#125;) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">            resolve();</span><br><span class="line">            userApi.getInfo()</span><br><span class="line">                .then(<span class="function"><span class="params">res</span> =&gt;</span> res.data)</span><br><span class="line">                .then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">const</span> &#123; result, msg, code &#125; = res;</span><br><span class="line">                <span class="keyword">if</span> (code == <span class="number">0</span>) &#123;</span><br><span class="line">                    commit(<span class="string">'SET_NAME'</span>, result.name)</span><br><span class="line">                    commit(<span class="string">'SET_ID'</span>, result.id)</span><br><span class="line">                    commit(<span class="string">'SET_ROLES'</span>, result.roles)</span><br><span class="line">                    resolve(res);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    reject(<span class="string">'error'</span>)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">                .catch(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">                reject(<span class="string">'error'</span>)</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure>

<p>在页面定义登录点击事件调用LoginByMobile即可。登录后获取token存入vuex和storage，再获取用户信息存入vuex。</p>
<p>如果是手机端微信登录需要使用openid（微信用户与公众号之间的唯一标识）登录。这里需用到微信的<a href="https://developers.weixin.qq.com/doc/offiaccount/OA_Web_Apps/Wechat_webpage_authorization.html" target="_blank" rel="noopener">jssdk</a>配合后台接口获取openid。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (getToken()) &#123; <span class="comment">// 验证是否含有token</span></span><br><span class="line">    <span class="comment">/* has token*/</span></span><br><span class="line">    <span class="keyword">if</span> (to.path === <span class="string">'/login'</span>) &#123;</span><br><span class="line">        next(&#123; <span class="attr">path</span>: <span class="string">'/'</span> &#125;)</span><br><span class="line">        NProgress.done()</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (store.getters.roles.length === <span class="number">0</span>) &#123; <span class="comment">// 判断当前用户是否已拉取完user_info信息</span></span><br><span class="line">            store.dispatch(<span class="string">'GetUserInfo'</span>).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123; <span class="comment">// 拉取user_info</span></span><br><span class="line">                <span class="keyword">const</span> roles = res.result.roles <span class="comment">// ['user','admin']</span></span><br><span class="line">                store.dispatch(<span class="string">'GenerateRoutes'</span>, &#123; roles &#125;).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123; <span class="comment">// 根据roles权限生成可访问的路由表</span></span><br><span class="line">                    router.addRoutes(store.getters.addRouters) <span class="comment">// 动态添加可访问路由表</span></span><br><span class="line">                    next(&#123; ...to, <span class="attr">replace</span>: <span class="literal">true</span> &#125;) <span class="comment">// hack方法 确保addRoutes已完成 ,set the replace: true so the navigation will not leave a history record</span></span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;).catch(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">                store.dispatch(<span class="string">'FedLogOut'</span>).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                    next(&#123; <span class="attr">path</span>: <span class="string">'/'</span> &#125;)</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            next()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> code = getUrlParam(<span class="string">'code'</span>)</span><br><span class="line">    <span class="keyword">const</span> openid = sessionStorage.getItem(<span class="string">'openid'</span>)</span><br><span class="line">    <span class="keyword">if</span> (code &amp;&amp; !openid) &#123;</span><br><span class="line">        <span class="comment">// 获取openid</span></span><br><span class="line">        login.getUserOpenId(&#123;</span><br><span class="line">            code: code</span><br><span class="line">        &#125;)</span><br><span class="line">            .then(<span class="function"><span class="params">res</span> =&gt;</span> res.data)</span><br><span class="line">            .then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (res.code == <span class="number">0</span>) &#123;</span><br><span class="line">                sessionStorage.setItem(<span class="string">'openid'</span>, res.openId)</span><br><span class="line">                <span class="keyword">if</span> (res.token) &#123;</span><br><span class="line">                    store.dispatch(<span class="string">'LoginSetToken'</span>, &#123;<span class="attr">token</span>: res.token&#125;).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123; <span class="comment">// 拉取user_info</span></span><br><span class="line">                        setToken(res.token)</span><br><span class="line">                        next()</span><br><span class="line">                    &#125;)</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    next(<span class="string">`/login`</span>) <span class="comment">// 否则全部重定向到登录页</span></span><br><span class="line">                    NProgress.done()</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(err)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!openid) &#123;</span><br><span class="line">            <span class="built_in">window</span>.location.href = <span class="string">`https://open.weixin.qq.com/connect/oauth2/authorize?appid=<span class="subst">$&#123;AppId&#125;</span>&amp;redirect_uri=http%3a%2f%2xx.xxx.com&amp;response_type=code&amp;scope=snsapi_userinfo&amp;state=STATE#wechat_redirect`</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">/* has no token*/</span></span><br><span class="line">            <span class="keyword">if</span> (whiteList.indexOf(to.path) !== <span class="number">-1</span>) &#123; <span class="comment">// 在免登录白名单，直接进入</span></span><br><span class="line">                next()</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                next(<span class="string">`/login`</span>) <span class="comment">// 否则全部重定向到登录页</span></span><br><span class="line">                NProgress.done()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="权限"><a href="#权限" class="headerlink" title="权限"></a>权限</h3><h4 id="路由权限"><a href="#路由权限" class="headerlink" title="路由权限"></a>路由权限</h4><p>做路由权限有两种，一种是动态路由，一种是静态路由。动态路由信息完全由后台数据库存储，通过接口去获取数据。静态路由则完全由前端控制，可通过不同角色去过滤路由。</p>
<p>静态路由</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* router.js */</span></span><br><span class="line"><span class="keyword">const</span> RouterDefault = [</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">'/'</span>,</span><br><span class="line">    name: <span class="string">'home1'</span>,</span><br><span class="line">    component: <span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">import</span>(<span class="string">'@/views/home/Home.vue'</span>), <span class="comment">// 普通用户</span></span><br><span class="line">    meta: &#123; <span class="attr">title</span>: <span class="string">'首页'</span>, <span class="attr">keepAlive</span>: <span class="literal">true</span>, <span class="attr">noCache</span>: <span class="literal">false</span>, <span class="attr">roles</span>: [<span class="string">"user"</span>] &#125;,</span><br><span class="line">  &#125;, &#123;</span><br><span class="line">    path: <span class="string">'/'</span>,</span><br><span class="line">    name: <span class="string">'other'</span>,</span><br><span class="line">    component: <span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">import</span>(<span class="string">'@/views/a_otherRoles/leader/home/index.vue'</span>), <span class="comment">// 其他用户</span></span><br><span class="line">    meta: &#123; <span class="attr">title</span>: <span class="string">'首页'</span>, <span class="attr">keepAlive</span>: <span class="literal">true</span>, <span class="attr">noCache</span>: <span class="literal">false</span>, <span class="attr">roles</span>: [<span class="string">"other"</span>] &#125;,</span><br><span class="line">  &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>过滤函数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 递归过滤异步路由表，返回符合用户角色权限的路由表</span></span><br><span class="line"><span class="comment"> * @param routes asyncRouterMap</span></span><br><span class="line"><span class="comment"> * @param roles</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filterAsyncRouter</span>(<span class="params">routes, roles</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> res = []</span><br><span class="line">  routes.forEach(<span class="function"><span class="params">route</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> tmp = &#123; ...route &#125;</span><br><span class="line">    <span class="keyword">if</span> (hasPermission(roles, tmp)) &#123;</span><br><span class="line">      <span class="keyword">if</span> (tmp.children) &#123;</span><br><span class="line">        tmp.children = filterAsyncRouter(tmp.children, roles)</span><br><span class="line">      &#125;</span><br><span class="line">      res.push(tmp)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> res</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>过滤路由并添加到vuex中</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">GenerateRoutes(&#123; commit &#125;, data) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; roles &#125; = data</span><br><span class="line">        <span class="keyword">let</span> accessedRouters</span><br><span class="line">        <span class="keyword">if</span> (roles.includes(<span class="string">'admin'</span>)) &#123;</span><br><span class="line">          accessedRouters = asyncRouterMap</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          accessedRouters = filterAsyncRouter(asyncRouterMap, roles)</span><br><span class="line">        &#125;</span><br><span class="line">        commit(<span class="string">'SET_ROUTERS'</span>, accessedRouters)</span><br><span class="line">        resolve()</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>如果是通过接口获取的路由信息则可以直接拼接静态路由和动态路由信息，当然获取路由信息需要在登录之后或者刷新页面的时候。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> Router(&#123;</span><br><span class="line">  mode: <span class="string">'history'</span>,</span><br><span class="line">  base: process.env.BASE_URL,</span><br><span class="line">  scrollBehavior: <span class="function"><span class="params">()</span> =&gt;</span> (&#123; <span class="attr">y</span>: <span class="number">0</span> &#125;),</span><br><span class="line">  routes: constantRouterMap</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> asyncRouterMap = [</span><br><span class="line">  ...RouterDefault,</span><br><span class="line">  &#123; <span class="attr">path</span>: <span class="string">'*'</span>, <span class="attr">redirect</span>: <span class="string">'/404'</span>, <span class="attr">hidden</span>: <span class="literal">true</span> &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>



<h4 id="按钮权限"><a href="#按钮权限" class="headerlink" title="按钮权限"></a>按钮权限</h4><p>按钮权限可以根据角色在前端判断是否展示；也可以在数据库中存储按钮信息，在按钮上绑定的接口权限，通过接口返回按钮信息，前端判断是否展示。</p>
<p>可以自定义定义指令实现按钮展示</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 检查是否包含按钮</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">permissionCheck</span>(<span class="params">code</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> permissionList = store.getters.permissions</span><br><span class="line">  <span class="keyword">const</span> stringCode = code.split(<span class="string">'||'</span>)</span><br><span class="line">  <span class="keyword">const</span> menuCode = stringCode[<span class="number">0</span>]</span><br><span class="line">  <span class="keyword">const</span> buttonCode = stringCode[<span class="number">1</span>]</span><br><span class="line">  <span class="keyword">let</span> checkFlag = <span class="literal">false</span></span><br><span class="line">  permissionList.some(<span class="function">(<span class="params">item, index</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (item.menuCode == menuCode) &#123;</span><br><span class="line">      <span class="keyword">if</span>(!!item.permitAll) &#123;</span><br><span class="line">        checkFlag = <span class="literal">true</span></span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        item.roleButtons.some(<span class="function">(<span class="params">itemBtn, indexBtn</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">if</span> (itemBtn.buttonCode == buttonCode) &#123;</span><br><span class="line">            checkFlag = <span class="literal">true</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="keyword">return</span> checkFlag</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @export 自定义指令</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">directive</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  Vue.directive(<span class="string">'permit'</span>, &#123;</span><br><span class="line">    bind(el, binding) &#123;</span><br><span class="line">      <span class="keyword">if</span>(!permissionCheck(binding.value)) &#123;</span><br><span class="line">        el.parentNode &amp;&amp; el.parentNode.removeChild(el)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在vue代码中可以使用<code>v-permit</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;el-button class=&quot;filter-item&quot;</span><br><span class="line">    v-permit=&quot;&apos;ROLE-SETTING||role_create&apos;&quot;</span><br><span class="line">    @click=&quot;handleCreate&quot;</span><br><span class="line">    size=&quot;small&quot;</span><br><span class="line">    type=&quot;primary&quot;</span><br><span class="line">    icon=&quot;el-icon-edit&quot;&gt;</span><br><span class="line">    添加</span><br><span class="line">&lt;/el-button&gt;</span><br></pre></td></tr></table></figure>



<h3 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h3><ol>
<li><p>vue缓存页面使用</p>
<p>在路由文件中添加<code>meta</code> </p>
 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    path: <span class="string">'newslist'</span>,</span><br><span class="line">    name: <span class="string">'NewsList'</span>,</span><br><span class="line">    meta: &#123;<span class="attr">keepAlive</span>: <span class="literal">true</span>&#125;,</span><br><span class="line">    component: <span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">import</span>(<span class="string">'@/pages/NewsList'</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> 在router-view处添加</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;keep-alive&gt;</span><br><span class="line">    &lt;router-view v-if=&quot;$route.meta.keepAlive&quot;&gt;&lt;/router-view&gt;</span><br><span class="line">&lt;/keep-alive&gt;</span><br><span class="line">&lt;router-view v-if=&quot;!$route.meta.keepAlive&quot;&gt;&lt;/router-view&gt;</span><br></pre></td></tr></table></figure>

<p> 这样页面就只会加载一次然后缓存起来，再次访问不回刷新数据。</p>
<p> 如果需要在另一个页面跳转过来刷新数据时，则需要使用<code>beforeRouteLeave</code> 关键是设置keepAlive</p>
 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">beforeRouteLeave(to, <span class="keyword">from</span>, next) &#123;</span><br><span class="line">    <span class="comment">// 设置下一个路由meta</span></span><br><span class="line">    to.meta.keepAlive = <span class="literal">false</span>; <span class="comment">// 让页面不缓存，重新请求数据</span></span><br><span class="line">    <span class="built_in">console</span>.log(to);</span><br><span class="line">    next(); <span class="comment">// 跳转页面</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>页面刷新vuex被清空</p>
<p> 同一页面，刷新后vuex被清空</p>
<ul>
<li><p>试用localstorage存储</p>
</li>
<li><p>重新获取数据</p>
<p>需要某些数据之前先判断一下数据是否存在，如果不存在重新获取。</p>
</li>
</ul>
</li>
</ol>
<ol start="3">
<li><p>nextTick适当使用</p>
<blockquote>
<p>延迟到下次dom更新循环之后执行延迟回调，在修改数据之后立即执行这个方法，获取最新的DOM。获取更新后的DOM言外之意就是什么操作需要用到了更新后的DOM而不能使用之前的DOM或者使用更新前的DOM或出问题，所以就衍生出了这个获取更新后的DOM的Vue方法。所以放在Vue.nextTick()回调函数中的执行的应该是会对DOM进行操作的 js代码.</p>
</blockquote>
<ul>
<li><p>你在Vue生命周期的created()钩子函数进行的DOM操作一定要放在Vue.nextTick()的回调函数中。</p>
<p>原因：在执行created时并没有dom渲染，此时进行dom操作无效，将执行dom操作的js代码放入nextTick回调函数中，与其相对应的是mounted钩子函数。</p>
</li>
<li><p>在数据变化后要执行的某个操作，而这个操作需要使用随数据改变而改变的DOM结构的时候，这个操作都应该放进Vue.nextTick()的回调函数中。</p>
<p>原因：vue是异步执行dom更新，一旦观察到数据变化，vue会开启一个队列，然后把在同一个事件循环 (event loop) 当中观察到数据变化的 watcher 推送进这个队列。如果这个watcher被触发多次，只会被推送到队列一次。这种缓冲行为可以有效的去掉重复数据造成的不必要的计算和DOm操作。而在下一个事件循环时，Vue会清空队列，并进行必要的DOM更新。</p>
<p>简而言之，等待DOM更新之后再进行操作。</p>
</li>
</ul>
</li>
</ol>
<ol start="4">
<li><p>组件之间的调用方式</p>
<p> 父子组件</p>
<ul>
<li><p>prop向下传递，事件向上传递</p>
</li>
<li><p>子组件添加ref属性，父组件可以获取到子组件的实例，不推荐使用</p>
</li>
<li><p>插槽slot 作用域插槽</p>
<p>非父子组件</p>
</li>
<li><p>使用状态管理</p>
</li>
<li><p>实例化一个公共vue实例</p>
<p>必须要有公共的实例（可以是空的），才能使用 <code>$emit</code> 获取 <code>$on</code> 的数据参数，实现组件通信 </p>
</li>
</ul>
</li>
</ol>
<ol start="5">
<li><p>计算属性设置值</p>
<blockquote>
<p>计算属性是基于它们的依赖进行缓存的，一旦依赖发生变化，计算属性会重新计算</p>
</blockquote>
<p> 通过set方法触发它所依赖的变量，单纯的赋值，在取值的时候不会被改变</p>
</li>
</ol>
<ol start="6">
<li><p>vue文件中内联样式中有无scoped属性的差别</p>
<ul>
<li>有scoped只在当前vue文件中可以使用这个样式</li>
<li>无scoped，会影响其他文件</li>
</ul>
</li>
</ol>
<ol start="7">
<li><p>v-for v-key</p>
<p> 为了给 Vue 一个提示，以便它能跟踪每个节点的身份，从而重用和重新排序现有元素，你需要为每项提供一个唯一 key 属性。</p>
</li>
</ol>
<ol start="8">
<li><p>v-for v-if</p>
<p> 当它们处于同一节点，v-for的优先级比v-if更高。</p>
</li>
</ol>
<ol start="9">
<li><p>组件、prop大小写不敏感，事件敏感</p>
<p> 不同于组件和 prop，事件名不存在任何自动化的大小写转换。而是触发的事件名需要完全匹配监听这个事件所用的名称。</p>
<p> 不同于组件和 prop，事件名不会被用作一个 JavaScript 变量名或属性名，所以就没有理由使用 camelCase 或 PascalCase 了。</p>
</li>
</ol>
<ol start="10">
<li><p>prop值的改变–不是立即</p>
<p>如果父组件中给子组件传递了一个prop的值，然后调用子组件的方法去获取该值，会发现值没有立即改变。</p>
<ul>
<li>可以监听值的改变去调用相应子组件的方法</li>
<li>将子组件相关方法的调用放在nextTick里面</li>
</ul>
</li>
</ol>
<ol start="11">
<li><p>对象中某属性值的监听</p>
<p>普通的<code>watch</code>中只能监听到某对象的变化才会调用，当想监听对象以及对象中属性的变化都调用函数时，可以使用<code>deep:true</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">data() &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    bet: &#123;</span><br><span class="line">      pokerState: <span class="number">53</span>,</span><br><span class="line">      pokerHistory: <span class="string">'local'</span></span><br><span class="line">    &#125;   </span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br><span class="line">watch: &#123;</span><br><span class="line">  bet: &#123;</span><br><span class="line">    handler(newValue, oldValue) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(newValue)</span><br><span class="line">    &#125;,</span><br><span class="line">    deep: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


</li>
</ol>
<ol start="12">
<li><p>this.$forceUpdate</p>
<p>强制刷新页面，触发页面重新渲染</p>
</li>
</ol>
<ol start="13">
<li><p>vue中的beforeRouteUpdate</p>
<p>在<code>xxx/detail/123</code>和<code>xxx/edit/123</code>都用了同一个组件，<code>beforeRouteUpdate</code>不生效，但是watch <code>$route</code>是生效的？</p>
<p>扩展： 可以考虑在路由定义处使用别名 alias</p>
<p>官方解释</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">beforeRouteUpdate (to, <span class="keyword">from</span>, next) &#123;</span><br><span class="line">    <span class="comment">// 在当前路由改变，但是该组件被复用时调用</span></span><br><span class="line">    <span class="comment">// 举例来说，对于一个带有动态参数的路径 /foo/:id，在 /foo/1 和 /foo/2 之间跳转的时候，</span></span><br><span class="line">    <span class="comment">// 由于会渲染同样的 Foo 组件，因此组件实例会被复用。而这个钩子就会在这个情况下被调用。</span></span><br><span class="line">    <span class="comment">// 可以访问组件实例 `this`</span></span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>





</li>
</ol>
<h3 id="简单部署"><a href="#简单部署" class="headerlink" title="简单部署"></a>简单部署</h3><ol>
<li><p>执行命令前端代码打包，生成dist打包后的文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn build</span><br></pre></td></tr></table></figure>
</li>
<li><p>将打包后的文件放至指定目录</p>
</li>
<li><p>配置nginx文件</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span>       <span class="number">80</span>;</span><br><span class="line">    <span class="attribute">listen</span>       [::]:<span class="number">80</span>;</span><br><span class="line">    <span class="attribute">server_name</span>  localhost;</span><br><span class="line">    <span class="attribute">location</span> / &#123;</span><br><span class="line">        <span class="attribute">root</span>    /var/www/html;</span><br><span class="line">        <span class="attribute">index</span>   index.html index.htm;</span><br><span class="line">        <span class="attribute">try_files</span> <span class="variable">$uri</span> <span class="variable">$uri</span>/ /index.html;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="attribute">location</span> /v2 &#123;</span><br><span class="line">            <span class="attribute">proxy_set_header</span> Host rap2api.taobao.org;</span><br><span class="line">            <span class="attribute">proxy_pass</span> http://rap2api.taobao.org;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>重启nginx</p>
</li>
</ol>
<h3 id="Docker部署"><a href="#Docker部署" class="headerlink" title="Docker部署"></a>Docker部署</h3><h4 id="项目打包部署步骤"><a href="#项目打包部署步骤" class="headerlink" title="项目打包部署步骤"></a>项目打包部署步骤</h4><ol>
<li><p>编写Dockerfile</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> docker-registry.xxx/docker/nginx:<span class="number">1.13</span>.<span class="number">6</span></span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> ./dist /var/www/html</span></span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> ./nginx.conf /etc/nginx/conf.d/ </span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> rm /etc/nginx/conf.d/default.conf</span></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">80</span></span><br><span class="line"><span class="keyword">CMD</span><span class="bash"> [<span class="string">"nginx"</span>,<span class="string">"-g"</span>,<span class="string">"daemon off;"</span>]</span></span><br></pre></td></tr></table></figure>



</li>
</ol>
<ol start="2">
<li><p>打包镜像</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build -t 镜像名 .</span><br></pre></td></tr></table></figure>
</li>
<li><p>启动容器</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -it --name 容器名 -p 80:80 镜像||id</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h4 id="docker安装"><a href="#docker安装" class="headerlink" title="docker安装"></a>docker安装</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ sudo yum remove docker \</span><br><span class="line">                  docker-client \</span><br><span class="line">                  docker-client-latest \</span><br><span class="line">                  docker-common \</span><br><span class="line">                  docker-latest \</span><br><span class="line">                  docker-latest-logrotate \</span><br><span class="line">                  docker-logrotate \</span><br><span class="line">                  docker-selinux \</span><br><span class="line">                  docker-engine-selinux \</span><br><span class="line">                  docker-engine</span><br><span class="line">$ sudo yum install -y yum-utils device-mapper-persistent-data lvm2</span><br><span class="line">$ sudo yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br><span class="line">$ sudo yum makecache fast</span><br><span class="line">$ sudo yum -y install docker-ce</span><br><span class="line">$ sudo systemctl start docker</span><br></pre></td></tr></table></figure>



<h4 id="查看日志"><a href="#查看日志" class="headerlink" title="查看日志"></a>查看日志</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker logs -f -t --since=“2017-05-31” --tail=10 容器</span><br><span class="line">–since : 此参数指定了输出日志开始日期，即只输出指定日期之后的日志。</span><br><span class="line">-f : 查看实时日志</span><br><span class="line">-t : 查看日志产生的日期</span><br><span class="line">-tail=10 : 查看最后的10条日志。</span><br></pre></td></tr></table></figure>



<h4 id="几个命令"><a href="#几个命令" class="headerlink" title="几个命令"></a>几个命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">docker start/stop/restart 容器id <span class="comment">#启动暂停重启</span></span><br><span class="line">docker rm 容器id <span class="comment">#删除</span></span><br><span class="line">docker <span class="built_in">kill</span> 容器id <span class="comment">#杀掉一个运行中的容器。</span></span><br><span class="line">docker pause/unpause 容器id <span class="comment">#暂停/取消暂停</span></span><br><span class="line">docker create 镜像 // 创建容器但是不运行</span><br><span class="line">docker <span class="built_in">exec</span> -i -t 容器 /bin/bash <span class="comment">#开启一个交互模式的终端</span></span><br><span class="line">docker rmi &lt;image id&gt; <span class="comment"># 移除镜像</span></span><br><span class="line">docker rmi $(docker images | grep <span class="string">"none"</span> | awk <span class="string">'&#123;print $3&#125;'</span>) <span class="comment">#移除为none的镜像</span></span><br><span class="line">docker rm $(docker ps -a | grep <span class="string">"Exited"</span> | awk <span class="string">'&#123;print $1 &#125;'</span>) <span class="comment">#移除为exited的容器</span></span><br><span class="line">docker images -a 查看镜像</span><br><span class="line">docker ps -a 查看容器</span><br></pre></td></tr></table></figure>
        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    最后更新时间：<time datetime="2020-08-23T15:45:11.821Z" itemprop="dateUpdated">2020-08-23 23:45:11</time>
</span><br>


        
    </div>
    
    <footer>
        <a href="https://qspinach.github.io/blog">
            <img src="/blog/img/avatar.jpg" alt="QSpinach">
            QSpinach
        </a>
    </footer>
</blockquote>

        


        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/Vue/" rel="tag">Vue</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://qspinach.github.io/blog/2020/08/23/%E6%90%AD%E5%BB%BAvue%E9%A1%B9%E7%9B%AE/&title=《搭建vue项目》 — QSpinach'blog&pic=https://qspinach.github.io/blog/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://qspinach.github.io/blog/2020/08/23/%E6%90%AD%E5%BB%BAvue%E9%A1%B9%E7%9B%AE/&title=《搭建vue项目》 — QSpinach'blog&source=个人收集，个人总结, qspinach, QSpinach" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://qspinach.github.io/blog/2020/08/23/%E6%90%AD%E5%BB%BAvue%E9%A1%B9%E7%9B%AE/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《搭建vue项目》 — QSpinach'blog&url=https://qspinach.github.io/blog/2020/08/23/%E6%90%AD%E5%BB%BAvue%E9%A1%B9%E7%9B%AE/&via=https://qspinach.github.io/blog" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://qspinach.github.io/blog/2020/08/23/%E6%90%AD%E5%BB%BAvue%E9%A1%B9%E7%9B%AE/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/blog/2020/10/19/mac%E4%BD%BF%E7%94%A8%E9%97%AE%E9%A2%98%E6%B1%87%E6%80%BB/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">mac使用问题汇总</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/blog/2020/08/23/%E6%80%BB%E7%BB%93/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">总结</h4>
      </a>
    </div>
  
</nav>



    




















</article>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
                <span><a href="/blog/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>博客内容遵循 <a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">知识共享 署名 - 非商业性 - 相同方式共享 4.0 国际协议</a></span>
        </p>
    </div>
    <div class="bottom">
        <p><span>QSpinach &copy; 2019 - 2020</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://qspinach.github.io/blog/2020/08/23/%E6%90%AD%E5%BB%BAvue%E9%A1%B9%E7%9B%AE/&title=《搭建vue项目》 — QSpinach'blog&pic=https://qspinach.github.io/blog/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://qspinach.github.io/blog/2020/08/23/%E6%90%AD%E5%BB%BAvue%E9%A1%B9%E7%9B%AE/&title=《搭建vue项目》 — QSpinach'blog&source=个人收集，个人总结, qspinach, QSpinach" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://qspinach.github.io/blog/2020/08/23/%E6%90%AD%E5%BB%BAvue%E9%A1%B9%E7%9B%AE/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《搭建vue项目》 — QSpinach'blog&url=https://qspinach.github.io/blog/2020/08/23/%E6%90%AD%E5%BB%BAvue%E9%A1%B9%E7%9B%AE/&via=https://qspinach.github.io/blog" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://qspinach.github.io/blog/2020/08/23/%E6%90%AD%E5%BB%BAvue%E9%A1%B9%E7%9B%AE/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACpklEQVR42u3a22rDMBAE0P7/T6fQp0JxMqOVnBSOnwy56bggbWf36yu+Hj/X1f3va/I9+f3mCw8PD29p6VfX3/dcfTb5tuTRrH328hHj4eHhHeOtHQbtj119dnKQvLDg4eHhvZWXLPfqO5OyO3lkeHh4eP+X1/7Yc17y+PDw8PA+jTfZiJOltwFEGx9vyFrw8PDwYt68AXb//a39PTw8PLz4SMi33bbgzg+S0Trx8PDwDvDaIao8nkiW28YNyUDDi6wFDw8PbxOvrUjzAYKc1w4oHCy48fDw8GLefFlrW3x+LE2GsfDw8PD28toyut2UJ82ttvV1GUbg4eHhbeLlsOQAWHtPO4BVjA7g4eHhHeO1o1Rrhe/ekjqKg/Hw8PAO8ObLfV4Kt+xJ62sxjMDDw8PbxJu08+8ZrsqDXTw8PLzTvHykYBLmrh0PbUyMh4eHd47Xtqna0au1bX0yyoCHh4d3P28eH+yNcdvmHB4eHt5p3trmnge4a0NXbZkeNcDw8PDwNvGSL52PZ+VHUfsr0UPBw8PD28TLt/s8VJ2UznmsXJ94eHh4eFt57fhUO6QVjUaVkUf00PHw8PBu582L4xw5Hyko/kvAw8PDG/N2HQl5+2rSHisKazw8PLzbeXnra9dhk4OjPwweHh7eAV4byM437ntCCjw8PLxzvDxoaGOF/Ehoh7HqQSs8PDy8rbzJFjzB5wV9O6CAh4eHd5r3KK9k6z/dGCseCh4eHt4B3loYkUQPaxNQedixLcDFw8PDW+Ltai+tjWo9X8MkFMbDw8M7zZsHuPmxkUcSG7IWPDw8vI/hrYWzeUm9tpLLAQI8PDy8N/HyVtnae9r75FU8PDy8c7w8jJgMSLWvJgX0iyADDw8P7wBv0gDbu9A2+NgAw8PDw+t434j9ac4fd+eVAAAAAElFTkSuQmCC" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/blog/', SHARE: true, REWARD: false };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>






<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = '死鬼去哪里了！';
            clearTimeout(titleTime);
        } else {
            document.title = '(つェ⊂)咦!又好了!';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
